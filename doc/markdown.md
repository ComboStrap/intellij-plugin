# Markdown


## Parsing

Markdown can't really be parsed with a LR parser.

### CommonMark parsing

Any lines not claimed by some block parser are claimed by the core ParagraphParser.

Pass to the active component the start of the line for space/indentation processing (creating an indentation token)
Pass to the component the fact that this is a start line (for block indentation based on space)

Disable block indentation based on space by default

Allow or disallow p inside a mode

### Common-markup-state-machine

It uses the [Common markup state machine](https://github.com/micromark/common-markup-state-machine)


The parser parses in three stages with their own state machines: 
  * flow ([flow state machine](https://github.com/micromark/common-markup-state-machine#flow-state-machine)) to make up the structure of the document (such as outline headings or thematic breaks)
    * content ([content state machine](https://github.com/micromark/common-markup-state-machine#content-state-machine)) to tokenize the inline constructs part of content blocks 
  * and text ([text state machine](https://github.com/micromark/common-markup-state-machine#text-state-machine)) to tokenize the inline constructs part of rich text (such as regular resources and emphasis) or plain text (such as regular character escapes or character references)


## Library
### FlexMark

https://github.com/vsch/flexmark-java

flexmark-java is a Java implementation of CommonMark (spec 0.28) parser using the blocks first,
inlines after Markdown parsing architecture.

It is a fork of [commonmark-java project](https://github.com/commonmark/commonmark-java), modified to generate an AST which reflects all the elements in the original source, full source position tracking for all elements in the AST and easier JetBrains Open API PsiTree generation.

### Gfm

The [lexer code](https://github.com/JetBrains/markdown/blob/master/src/commonMain/kotlin/org/intellij/markdown/flavours/gfm/lexer/_GFMLexer.kt) was generated by JFlex 1.7.0 tweaked for IntelliJ platform



### Lezer (CodeMirror)

  * https://github.com/lezer-parser/markdown

### Unified (Remark)

[micromark](https://github.com/micromark/micromark) is the parser that creates
 the syntax tree and have plugin.


Then [Remark](https://github.com/remarkjs/remark) is the tree processor and have [plugins](https://github.com/remarkjs/remark/blob/main/doc/plugins.md#list-of-plugins) that modify it via tree traversal.

Example:
* [ramark-hint](https://github.com/sergioramos/remark-hint), transform a [paragraph node](https://github.com/sergioramos/remark-hint/blob/master/index.js#L29) to add a class.
* [new image syntax](https://github.com/remarkjs/remark-images/blob/main/index.js#L44) visit text node


## Ref

[Test File](https://github.com/vsch/flexmark-java/blob/7c187fb2bcf3bbdad4a75226a746aee752255675/flexmark-test-specs/src/main/resources/spec.txt)

